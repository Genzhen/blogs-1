<!DOCTYPE html>
<html>
<head>
    <meta name="wap-font-scale" content="no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <title>Result</title>
    <link rel="stylesheet" href="https://os.alipayobjects.com/rmsportal/PmAIFlrKSTLuatH.css" media="screen" title="no title" charset="utf-8">
    <style media="screen">
        html, body{
            font-size: 16px;
            background-color:#39B3C4;
            font-family: "微软雅黑", "Microsoft Yahei", "黑体", sans-serif;
            position: relative;
        }
        #content{
            background: url('https://os.alipayobjects.com/rmsportal/lUwNYKjbMApzJSG.png') no-repeat;
            background-size: cover;
            position: relative;
        }
        .result-container{
            margin: 0 auto;
        }
        .result-container canvas{
            position: relative;
            top: 20%;
        }

        .four-box{
            position:absolute;
            width:50%;
            line-height:32px;
            text-align: center;
            color:white;
        }
        .box-title{
            font-size: 20px;
            font-family: 黑体;
        }
        .box-detail{
            color:#A3DCDF;
            font-size:14px;
        }
        .pass-container{
            top: 54%;
            left:0;
        }
        .surplus-container{
            top: 54%;
            left:50%;
        }
        .beat-container{
            left:0;
            top: 77%;
        }
        .error-container{
            left:50%;
            top: 77%;
        }

        .exam-result-return {
            position: relative;
        	color: #FFFFFF;
        	text-align: left;
        	font-size:36px;
        	height: 45px;
            line-height: 45px;
            background-color: #141926;
            text-align: center;
        }
        .exam-result-return * {
            vertical-align: middle;
        }
        .exam-result-return .return {
            font-size: 18px;
            margin-left: 8px;
            font-family: sans-serif;
            float: left;
        }
        .exam-result-return .result{
            font-size: 20px;
            font-family: 黑体;
            vertical-align: bottom;
            max-width: 80%;
            display: inline-block;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .exam-result-button{
            height: 24px;
            width: 48px;
            display: inline-block;
            border-radius: 24px;
            line-height: 24px;
            text-decoration: none;
            font-size: 15px;
            color: #fff;
            text-align: center;
            margin: 10px;
            float: right;
        }

        #btns-box{
            height: 50px;
            line-height: 50px;
        }
        #btns-box .btn{
            font-size:15px;
            background-color:#FFFFFF;
            color:#ADADAD;
            border: none;
            width: 50%;
            height: 100%;
            line-height: 100%;
            text-decoration: none;
            text-align: center;
        }
        #btns-box .btn:hover{
            background-color:#0098D5;
            color:#FFF;
        }
        .btn-index{
            float:left;
        }
        .btn-reexamine{
            float:right;
        }
        #btns-box .btn *{
            vertical-align: middle;
            display: inline-block;
            margin-top: 10px;
        }
        .submit-icon{
            margin-right:10px;
        }
        .record-icon{
            margin-right:10px;
        }
        @media only screen and (min-device-width: 320px) and (max-device-width: 320px) {
            .result-container canvas{
                font-size: 13px;
            }
        }
        @media only screen and (min-device-width: 321px) and (max-device-width: 410px) {
            .result-container canvas{
                font-size: 16px;
            }
        }
        @media only screen and (min-device-width: 411px) and (max-device-width: 460px) {
            .result-container canvas{
                font-size: 18px;
            }
        }
        @media only screen and (min-device-width: 461px){
            .result-container canvas{
                font-size: 20px;
            }
        }
        .return {
            width: 45px;
            height: 45px;
            background: url(/img/back.png) left center no-repeat;
            background-size:50%;
            text-decoration: none;
        }
        .result {
            display: inline-block;
            width: 80%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .exam-result-return a {
            position: absolute;
            top: 0;
        }
        .exam-result-return .return {
           left: 0.2rem;
        }
        .exam-result-return .exam-result-button {
            right: 0.2rem;
        }
        sub {
            font-size: x-small;
        }
        .show-explain-mask{
            background-color:rgba(0, 0, 0, 0.6);
            position:fixed;
            top:0;
            z-index: 999;
            text-align:center;
            width:100%;
            height:100%;
            color:#fff;
            font: 18px 黑体;
        }
        .mask-con{
            position: absolute;
            top: 50%;
            width: 100%;
            margin-top: -80px;
            text-align: center;
        }
        .show-explain-dialog{
            position:fixed;
            top:50%;
            width:90%;
            margin-left:5%;
            z-index: 1000;
            height: 130px;
            margin-top:-65px;
            border-radius: 5px;
            background-color: #FFF;
        }
        .dialog-content{
            height: 50px;
            line-height: 25px;
            color: #333;
            text-align: center;
            padding: 16px;
        }
        .dialog-btns{
            height: 50px;
            line-height: 47px;
            border-top: 1px solid #D9D9D9;
        }
        .dialog-btns span, .dialog-btns a{
            width: 49%;
            display: inline-block;
            text-align: center;
            color: #01AAEE;
            text-decoration: none;
        }
        .dialog-btn-cancel{
            border-left: 1px solid #D9D9D9;
        }
    </style>
</head>
<body>
<div class="exam-result-return">
    <a href="learnTrainingPersonRecord.htm?id=$!value.trainingId" class="return">&nbsp;</a>
    <span class="result">考试结果</span>
    <a class="exam-result-button" id="showDialog" href="javascript:void(0);">解析</a>
</div>
<div id="content">
    <div count="60" highest="100" class="result-container">60|100</div>
    <!--是否通过-->
    <div class="four-box pass-container">
        <div class="box-title">Passed</div>
        <div class="box-detail">测试结果</div>
    </div>
    <!--剩余考试-->
    <div class="four-box surplus-container">
        <div class="box-title"><span>2</span><sub> 次</sub></div>
        <div class="box-detail">剩余考试次数</div>
    </div>
    <!--击败比率-->
    <div class="four-box beat-container">
        <div class="box-title"><span>22</span><sub> %</sub></div>
        <div class="box-detail">打败学员比例</div>
    </div>
    <!--错误率-->
    <div class="four-box error-container">
        <div class="box-title"><span>10</span><sub> %</sub></div>
        <div class="box-detail">错误率</div>
    </div>
</div>

<div id="btns-box">
    <a class="btn btn-index" href="trainingCenter.htm"><img src="https://os.alipayobjects.com/rmsportal/TxrIyFGPDljzPpO.png" height="50%" class="submit-icon"></img><span>返回首页</span></a>
    <a class="btn btn-reexamine" href="beforeExam.htm?userId=$!value.actorId&examId=$!value.examId&paperId=$!value.paperId&trainingId=$!value.trainingId&isRepeatExam=true"><img src="https://os.alipayobjects.com/rmsportal/tnRMCgSoBjczUDr.png" height="50%" class="record-icon"></img><span>重新考试</span></a>
</div>

<script src="https://os.alipayobjects.com/rmsportal/vJiWrkscXQXdURo.js"></script>
<script type="text/javascript">
    $(function(){
        Zepto.fn.annular = function(){
            var m = 8,  //放大倍数，解决高清屏幕下canvas字体模糊情况
                me = $(this),
                w = me.width(),
                h = me.height(),
                text = me.text();
            $(this).html('<canvas class="annular" width="'+w*m+ '" height="'+h*0.8*m+'" style="width:'+w+'px;height:'+h*0.8+'px;">'+text+'</canvas');
            $('.annular', $(this)).each(function(){
                var canvas = this,
                    w = canvas.width,
                    h = canvas.height,
                    ctx = canvas.getContext('2d'),
                    text = $(this).text(),
                    tempArr = text.split('|'),
                    num = tempArr[0] - 0,
                    content = '',
                    copywrite = '本次得分',
                    numText = '',
                    rate = 0,
                    color = '#FFF';

                if(num === undefined || status === undefined) return;

                content = '已考 '+me.attr("count")+'次，最高 '+me.attr("highest")+'分';
                numText = num + '';
                rate = num / tempArr[1];

                //画底色圆形
                ctx.clearRect(0, 0, w, h);
                ctx.beginPath();
                ctx.lineWidth = 12;
                ctx.lineCap = "round";
                ctx.strokeStyle = "#379176";
                ctx.arc(w / 2, h / 2, h / 2 * 0.45 * m, Math.PI * 0.85, Math.PI * 0.15, false);
                ctx.stroke();
                ctx.closePath();

                //画进度圆形
                ctx.beginPath();
                ctx.strokeStyle = color;
                ctx.lineWidth = 12;
                ctx.lineCap = "round";
                ctx.arc(w / 2, h / 2, h / 2 * 0.45 * m, Math.PI * 0.85, Math.PI * ((2 - (0.85- 0.15)) * rate + 0.85), false);
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.font = 0.9 * m + "em 微软雅黑";
                ctx.fillStyle = "#A1DDE0";

                ctx.fillText(copywrite, w / 2 - ctx.measureText(copywrite).width / 2, h * 0.22);
                ctx.save();
                ctx.font = 4 * m + "em 微软雅黑";
                ctx.fillStyle = "#FFFFFF";
                ctx.fillText(numText, w / 2 - ctx.measureText(numText).width / 2, h * 0.55);
                ctx.restore();
                ctx.font = 0.8 * m + "em 微软雅黑";
                ctx.fillText(content, w / 2 - ctx.measureText(content).width / 2, h * 0.7);
                ctx.closePath();
            });
        };

        var bw,bh,rate,contentH,ori = innerWidth / innerHeight;
        if(window.orientation !== undefined){
            if(orientation === 90 || orientation === -90){
                rate = innerWidth / innerHeight;
            }else if(orientation === 0 || orientation === 180){
                rate = innerHeight / innerWidth;
            }
        }else{
            if(ori > 1){
                rate = innerWidth / innerHeight;
            }else{
                rate = innerHeight / innerWidth;
            }
        }
        bh = rate * innerWidth;
        bw = innerWidth;
        $('body').css({
            'height': bh + 'px',
            'width': bw + 'px'
        });
        contentH = bh - 45 - 50;
        $('#content').css({
            'height': contentH + 'px',
            'width': bw + 'px',
            'background-size': bw + 'px ' + contentH + 'px'
        });
        $('.result-container').css({
            'height': '50%'
        });
        $(window).on('orientationchange', function(){
            location.reload();
        });

        $('.result-container').annular();

        $("#showDialog").on("click tap", function(e) {
            $(".show-explain-dialog,.show-explain-mask").show();
        });
        $('.dialog-btn-cancel').on('click tap', function(e){
            $('.show-explain-dialog,.show-explain-mask').hide();
        });

        //悬浮效果
        $('.btn-reexamine').on("click tap", function(e) {
            var that = this;
            $('img', this).attr('src', 'https://os.alipayobjects.com/rmsportal/RPjqsMaqmPuiavK.png');
            setTimeout(function(){
                $('img', this).attr('src', 'https://os.alipayobjects.com/rmsportal/tnRMCgSoBjczUDr.png');
            }, 500);
        });

        $('.btn-index').on("click tap", function(e) {
            var that = this;
            $('img', this).attr('src', 'https://os.alipayobjects.com/rmsportal/cDZwfpufjvyrEtW.png');
            setTimeout(function(){
                $('img', this).attr('src', 'https://os.alipayobjects.com/rmsportal/TxrIyFGPDljzPpO.png');
            }, 500);
        });
    });
</script>

</body>
</html>
